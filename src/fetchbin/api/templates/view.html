<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>FetchBin</title>
        <style>
            .terminal-output {
                background-color: black;
                color: white;
                padding: 15px;
                font-family: monospace;
                white-space: pre-wrap;
                overflow-x: auto;
            }

            /* Koyu temada güzel görünecek ANSI renkleri (Doğru Sınıflarla) */
            .ansi1 {
                font-weight: bold;
            }

            .ansi30 {
                color: #4e4e4e;
            }

            /* Black */
            .ansi31 {
                color: #ff6b6b;
            }

            /* Red */
            .ansi32 {
                color: #6bcb77;
            }

            /* Green */
            .ansi33 {
                color: #ffc107;
            }

            /* Yellow */
            .ansi34 {
                color: #54a0ff;
            }

            /* Blue */
            .ansi35 {
                color: #ff69b4;
            }

            /* Magenta */
            .ansi36 {
                color: #48dbfb;
            }

            /* Cyan */
            .ansi37 {
                color: #dcdcdc;
            }

            /* White */
            /* Arkaplan Renkleri */
            .ansi40 {
                background-color: #4e4e4e;
            }

            .ansi41 {
                background-color: #ff6b6b;
            }

            .ansi42 {
                background-color: #6bcb77;
            }

            .ansi43 {
                background-color: #ffc107;
            }

            .ansi44 {
                background-color: #54a0ff;
            }

            .ansi45 {
                background-color: #ff69b4;
            }

            .ansi46 {
                background-color: #48dbfb;
            }

            .ansi47 {
                background-color: #dcdcdc;
            }
        </style>
    </head>
    <body>
        <h3>
            Output ID: {{ public_id }} | <a href="/raw/{{ public_id }}">View Raw</a>
        </h3>
        <p>
            Shared at: {{ created_at }}
            {% if tool_name %}| Using: <strong>{{ tool_name }}</strong>{% endif %}
        </p>
        <div id="vote-widget">
            <button id="upvote-btn" title="Upvote">▲</button>
            <span id="score" title="Score">{{ upvotes - downvotes }}</span>
            <button id="downvote-btn" title="Downvote">▼</button>
        </div>
        <p id="vote-message" style="color: #ff6b6b; font-size: 0.9em;"></p>
        <pre class="terminal-output">{{ html_content | safe }}</pre>
        <p>
            <a href="/delete/{{ delete_token }}">Delete this share</a>
        </p>
        <script>
        const upvoteBtn = document.getElementById('upvote-btn');
        const downvoteBtn = document.getElementById('downvote-btn');
        const scoreEl = document.getElementById('score');
        const messageEl = document.getElementById('vote-message');
        const publicId = '{{ public_id }}';

        upvoteBtn.addEventListener('click', async () => {
            await vote('upvote');
        });

        downvoteBtn.addEventListener('click', async () => {
            await vote('downvote');
        });

        async function vote(voteType) {
            try {
                const response = await fetch(`/api/c/${publicId}/${voteType}`, { method: 'POST' });
                if (response.ok) {
                    const data = await response.json();
                    scoreEl.textContent = data.upvotes - data.downvotes;
                    messageEl.textContent = 'Vote counted!';
                    messageEl.style.color = '#6bcb77';
                    disableButtons();
                } else if (response.status === 409) {
                    messageEl.textContent = 'You have already voted for this share.';
                    disableButtons();
                } else {
                    messageEl.textContent = 'An error occurred while voting.';
                }
            } catch (error) {
                messageEl.textContent = 'A network error occurred.';
            }
        }

        function disableButtons() {
            upvoteBtn.disabled = true;
            downvoteBtn.disabled = true;
        }
        </script>
    </body>
</html>
